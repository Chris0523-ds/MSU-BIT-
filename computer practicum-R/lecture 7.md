# lecture 7
## 利率期限结构的计算，R中的数据输入，即期和远期利率

## 远期利率
远期利率（远期贷款），也简称为远期利率（форвардными ставками）。
远期贷款是银行目前与客户签订的协议，在未来的特定时间以今天商定的利率向他发放贷款或存款。必须记住，远期汇率不一定等于将来出现的即期汇率 **(спотовыми ставками)** 。
远期汇率与即期汇率 **(спотовыми ставками)** 密切相关。

## 无套利的概念
考虑两种投资策略:
1.购买一年交易的两年期零息债券，收益率为$𝑦_2$，然后两年期收益率为$(1 + 𝑦_2)^2$。
2.购买一年期零息债券，以及提前一年购买一年期零息债券。
该策略两年后的增长盈利能力如下：
$$
\left(1+y_{2}\right)^{2}=\left(1+y_{1}\right)\left(1+f_{(1,1)}\right)
$$
$𝑓(1,1)$ - 表示远期利率，第一个指数 1 年表示该合约开始的一年，第二个下标指数也等于 1 - 这是合约的期限。该指数表明该贷款协议的到期日。
无套利条件确保两种策略的收益必须相同。否则，投资者总能找到套利机会，通过以较高价格出售策略并同时以较低价格购买策略来赚取无风险利润。
只要存在所需的即期汇率，就可以计算任何时期 𝑇 和任何到期日的远期汇率。
$$
\left(1+y_{T}\right)^{T}=\left(1+y_{T-i}\right)^{T-i}\left(1+f_{(T-i, i)}\right)^{i}
$$
那么
$$
\left(1+f_{(T-i, i)}\right)^{i}=\frac{\left(1+y_{T}\right)^{T}}{\left(1+y_{T-i}\right)^{T-i}}
$$
$$
f_{(T-i, i)}=\left(\frac{\left(1+y_{T}\right)^{T}}{\left(1+y_{T-i}\right)^{T-i}}\right)^{1 / i}-1
$$
根据定义：$f_{(0,1)}=y_{1}$
## 如何绘制零息收益率曲线？
### Метод бутстреппинга
如果零息债券的市场价格已知并且债券的发行期限为所有期限，则这些债券的市场价格可用于计算其收益率，然后用于绘制收益率曲线。
一年以上到期的零息债券在市场上很少见，因为息票支付对投资者更具吸引力。为了构建涵盖一年以上的收益率曲线，我们将使用息票债券的可用数据。
构建收益率曲线的一种方法称为 **(бутстреппингом)**。
债券的公允价格：
$$
P(T)=\sum_{t=1}^{T} \frac{c}{\left(1+y_{t}\right)^{t}}+\frac{M}{\left(1+y_{T}\right)^{T}}
$$
从这里我们得到估计的方程 $𝑦_{T}$:
$$
y_{T}=\left(\frac{c+M}{P(T)-\sum_{t=1}^{T-1} \frac{c}{\left(1+y_{t}\right)^{t}}}\right)^{1/T}-1
$$
一个例子说明计算过程：
$$
\begin{aligned}
\
&\begin{array}{|l|l|l|}
\hline \begin{array}{l}
\text { Время до погашения }
\end{array} & \text { Купон（优惠） } & \text { Цена облигации(债券价格) } \\
\hline 1 & 5,25 & 101,5 \\
\hline 2 & 5,25 & 102,1 \\
\hline
\end{array}
\end{aligned}
$$
计算可以得到：
$$
\begin{gathered}
y_{1}=\frac{100+5,25}{101,5}-1=0,0369=3,67 \% \\
y_{2}=\left(\frac{100+5,25}{102,1-\frac{5,25}{1+0,0369}}\right)^{1 / 2}-1=0,04146=4,15 \%
\end{gathered}
$$

无套利条件确保该债券的收益率与任何其他年份的零息债券收益率相同。
### 矩阵法
假设市场上有流通期限为一年至 $𝑇$ 年的息票债券，总共有 $𝑇$ 息票债券，这些息票债券的最长期限也是 $𝑇$ 年。
如果我们使用折扣因子 $D F_{t}=\frac{1}{\left(1+y_{t}\right)^{t}}$ 重写这些公式, 则对于每只债券的公平债券价格，方程组可以写成：
$$
P_{i}(T)=\sum_{t=1}^{T} \frac{c_{i}^{t}}{\left(1+y_{t}\right)^{t}}+\frac{M_{i}}{\left(1+y_{T}\right)^{T}} \quad i=1, \ldots, T
$$

任何债券的价格只是所有贴现未来现金流的总和。
$$
P_{i}(T)=\sum_{t=1}^{T} S_{i}^{t} D F_{t} \quad i=1, \ldots, T
$$
$S_{i}^{t}$ - 债券现金流量，$S_{i}^{t}$ - 对于 $t$ 值大于债券流通期 $i$ 时为零。
或以矩阵形式：
$$
P=S \cdot D F
$$
其中 $P$ - 债券的市场价格，$S$ - 一组债券的现金流量， $D F$ - 折扣乘数向量。
针对 $D F$ 折扣因子求解该系统并根据公式重新计算
$$
F_{t}=\frac{1}{\left(1+y_{t}\right)^{t}}
$$
我们将找到市场回报 $y_{t}$ 。
Метод бутстреппинга 和矩阵法是估计市场收益的方法，这些方法的基本原理是不存在套利的条件。 如果市场上有其他贴现因子的债券，那么投资者可以（理论上）通过进行债券“买卖”交易获得额外收益。
```R
# library(MASS)
# 求解线性方程组
mBonds <- (read.table("clipboard"))
mBonds 
mPrice <- (read.table("clipboard"))
mPrice
mB <- (as.matrix(mBonds))
mB
mP <- (as.matrix(mPrice))
dicontFact <- ginv(mB) %*% mP
dicontFact
d_f <- solve(mB,mP)
d_f
d_f[1]
n <- 1:3
n
i_n <- (1/d_f)^(1/n)-1
i_n
plot(n,i_n, type ='b',col ='blue')
```
## 矩阵
### 矩阵规格
可以使用 matrix() 函数从数值向量创建数值矩阵：
```R
matrix(x, nrow, ncol, byrow, dimnames)
```
指定矩阵，需要数据``x``的数组，需要指定行数``nrow = m``和/或列数``ncol = n``（默认行数等于列数和等于 1); 确定向量 ``x`` 的元素如何填充矩阵 - 按行或按列（默认情况下，矩阵按列填充）。 结果，向量中的元素将被写入指定大小的矩阵。 ``dimnames`` 参数是两个组件的列表，第一个设置行的名称，第二个设置列的名称（默认情况下，不设置行和列的名称）。
```R
>matrix(1:6, nrow = 2, ncol = 3)
 [,1] [,2] [,3]
[1,] 1 3 5
[2,] 2 4 6
```
```R
matrix(1:6, nrow = 2, ncol = 3, 
byrow=T,list(c(1,2),c('A','B','C')))
```
如果列数不是矩阵中元素数的倍数，则会发出警告:
```R
>A=matrix(1:12, ncol = 5);A
Warning message:
In matrix(1:12, ncol = 5) :
 数据长度 [12] 不是列数 [5] 的约数或倍数
 [,1] [,2] [,3] [,4] [,5]
[1,] 1 4 7 10 1
[2,] 2 5 8 11 2
[3,] 3 6 9 12 3
>
```
函数 ``nrow(A)``、``ncol(A)`` 和 ``dim(A)`` 分别返回矩阵 A 的行数、列数和维数。
```R
>nrow(A)
[1] 3
>
```
